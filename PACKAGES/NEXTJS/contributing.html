<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>contributing</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="contributing-to-next.js">Contributing to Next.js</h1>
    <p>
      Read about our
      <a href="https://vercel.com/oss">Commitment to Open Source</a>. To
      contribute to <a href="examples">our examples</a>, please see
      <strong><a href="#adding-examples">Adding examples</a></strong> below.
    </p>
    <h2 id="developing">Developing</h2>
    <p>
      The development branch is <code>canary</code>, and this is the branch that
      all pull requests should be made against. After publishing a stable
      release, the changes in the <code>canary</code> branch are rebased into
      <code>master</code>. The changes on the <code>canary</code> branch are
      published to the <code>@canary</code> dist-tag daily.
    </p>
    <p>To develop locally:</p>
    <ol type="1">
      <li>
        <a href="https://help.github.com/articles/fork-a-repo/">Fork</a> this
        repository to your own GitHub account and then
        <a href="https://help.github.com/articles/cloning-a-repository/"
          >clone</a
        >
        it to your local device.
      </li>
      <li>
        <p>Create a new branch:</p>
        <pre><code>git checkout -b MY_BRANCH_NAME</code></pre>
      </li>
      <li>
        <p>Install yarn:</p>
        <pre><code>npm install -g yarn</code></pre>
      </li>
      <li>
        <p>Install the dependencies with:</p>
        <pre><code>yarn</code></pre>
      </li>
      <li>
        <p>Start developing and watch for code changes:</p>
        <pre><code>yarn dev</code></pre>
      </li>
      <li>
        <p>
          In a new terminal, run <code>yarn types</code> to compile declaration
          files from TypeScript.
        </p>
        <p>
          <em
            >Note: You may need to repeat this step if your types get
            outdated.</em
          >
        </p>
      </li>
    </ol>
    <p>
      For instructions on how to build a project with your local version of the
      CLI, see
      <strong
        ><a href="#developing-with-your-local-version-of-nextjs"
          >Developing with your local version of Next.js</a
        ></strong
      >
      below. (Naively linking the binary is not sufficient to develop locally.)
    </p>
    <h2 id="building">Building</h2>
    <p>You can build the project, including all type definitions, with:</p>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode bash"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="ex">yarn</span> build</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># - or -</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="ex">yarn</span> prepublish</a></code></pre>
    </div>
    <p>
      If you need to clean the project for any reason, use
      <code>yarn clean</code>.
    </p>
    <h2 id="testing">Testing</h2>
    <p>
      See the <a href="./test/readme.md">testing readme</a> for information on
      writing tests.
    </p>
    <p>
      You may have to
      <a href="https://www.rust-lang.org/tools/install">install Rust</a> and
      build our native packages to see all tests pass locally. We check in
      binaries for the most common targets and those required for CI so that
      most people don’t have to, but if you do not see a binary for your target
      in <code>packages/next/native</code>, you can build it by running
      <code>yarn --cwd packages/next build-native</code>. If you are working on
      the Rust code and you need to build the binaries for ci, you can manually
      trigger
      <a
        href="https://github.com/vercel/next.js/actions/workflows/build_native.yml"
        >the workflow</a
      >
      to build and commit with the “Run workflow” button.
    </p>
    <h3 id="running-tests">Running tests</h3>
    <div class="sourceCode" id="cb6">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="ex">yarn</span> testonly</a></code></pre>
    </div>
    <p>
      If you would like to run the tests in headless mode (with the browser
      windows hidden) you can do
    </p>
    <div class="sourceCode" id="cb7">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="ex">yarn</span> testheadless</a></code></pre>
    </div>
    <p>
      Running a specific test suite inside of the
      <code>test/integration</code> directory:
    </p>
    <div class="sourceCode" id="cb8">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="ex">yarn</span> testonly --testPathPattern <span class="st">&quot;production&quot;</span></a></code></pre>
    </div>
    <p>Running one test in the <code>production</code> test suite:</p>
    <div class="sourceCode" id="cb9">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1"><span class="ex">yarn</span> testonly --testPathPattern <span class="st">&quot;production&quot;</span> -t <span class="st">&quot;should allow etag header support&quot;</span></a></code></pre>
    </div>
    <h3 id="running-the-integration-apps">Running the integration apps</h3>
    <p>Running examples can be done with:</p>
    <div class="sourceCode" id="cb10">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" title="1"><span class="ex">yarn</span> next ./test/integration/basic</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co"># OR</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="ex">yarn</span> next ./examples/basic-css/</a></code></pre>
    </div>
    <p>
      To figure out which pages are available for the given example, you can
      run:
    </p>
    <div class="sourceCode" id="cb11">
      <pre
        class="sourceCode sh"
      ><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1"><span class="va">EXAMPLE=</span>./test/integration/basic</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">(\</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="bu">cd</span> <span class="va">$EXAMPLE</span>/pages<span class="kw">;</span> <span class="kw">\</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="fu">find</span> . -type f \</a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">|</span> <span class="fu">grep</span> -v <span class="st">&#39;\.next&#39;</span> \</a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s#^\.##&#39;</span> \</a>
<a class="sourceLine" id="cb11-7" title="7">  <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s#index\.js##&#39;</span> \</a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="kw">|</span> <span class="fu">sed</span> <span class="st">&#39;s#\.js$##&#39;</span> \</a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="kw">|</span> <span class="fu">xargs</span> -I{} <span class="bu">echo</span> localhost:3000{} <span class="kw">\</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="kw">)</span></a></code></pre>
    </div>
    <h2 id="developing-with-your-local-version-of-next.js">
      Developing with your local version of Next.js
    </h2>
    <p>
      There are two options to develop with your local version of the codebase:
    </p>
    <h3 id="set-as-local-dependency-in-package.json">
      Set as local dependency in package.json
    </h3>
    <ol type="1">
      <li>
        <p>In your app’s <code>package.json</code>, replace:</p>
        <div class="sourceCode" id="cb12">
          <pre
            class="sourceCode json"
          ><code class="sourceCode json"><a class="sourceLine" id="cb12-1" title="1"><span class="er">&quot;next&quot;:</span> <span class="er">&quot;&lt;next-version&gt;&quot;,</span></a></code></pre>
        </div>
        <p>with:</p>
        <div class="sourceCode" id="cb13">
          <pre
            class="sourceCode json"
          ><code class="sourceCode json"><a class="sourceLine" id="cb13-1" title="1"><span class="er">&quot;next&quot;:</span> <span class="er">&quot;file:/path/to/next.js/packages/next&quot;,</span></a></code></pre>
        </div>
      </li>
      <li>
        <p>
          In your app’s root directory, make sure to remove
          <code>next</code> from <code>node_modules</code> with:
        </p>
        <div class="sourceCode" id="cb14">
          <pre
            class="sourceCode sh"
          ><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" title="1"><span class="fu">rm</span> -rf ./node_modules/next</a></code></pre>
        </div>
      </li>
      <li>
        <p>In your app’s root directory, run:</p>
        <div class="sourceCode" id="cb15">
          <pre
            class="sourceCode sh"
          ><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" title="1"><span class="ex">yarn</span></a></code></pre>
        </div>
        <p>to re-install all of the dependencies.</p>
        <p>
          Note that Next will be copied from the locally compiled version as
          opposed to from being downloaded from the NPM registry.
        </p>
      </li>
      <li><p>Run your application as you normally would.</p></li>
      <li>
        <p>
          To update your app’s dependencies, after you’ve made changes to your
          local <code>next</code> repository. In your app’s root directory, run:
        </p>
        <div class="sourceCode" id="cb16">
          <pre
            class="sourceCode sh"
          ><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="ex">yarn</span> install --force</a></code></pre>
        </div>
      </li>
    </ol>
    <p>or</p>
    <h3 id="develop-inside-the-monorepo">Develop inside the monorepo</h3>
    <ol type="1">
      <li><p>Move your app inside of the Next.js monorepo.</p></li>
      <li>
        <p>Run with <code>yarn next-with-deps ./app-path-in-monorepo</code></p>
      </li>
    </ol>
    <p>
      This will use the version of <code>next</code> built inside of the Next.js
      monorepo and the main <code>yarn dev</code> monorepo command can be
      running to make changes to the local Next.js version at the same time
      (some changes might require re-running <code>yarn next-with-deps</code> to
      take affect).
    </p>
    <h2 id="adding-warningerror-descriptions">
      Adding warning/error descriptions
    </h2>
    <p>
      In Next.js we have a system to add helpful links to warnings and errors.
    </p>
    <p>
      This allows for the logged message to be short while giving a broader
      description and instructions on how to solve the warning/error.
    </p>
    <p>
      In general all warnings and errors added should have these links attached.
    </p>
    <p>Below are the steps to add a new link:</p>
    <ol type="1">
      <li>
        <p>
          Create a new markdown file under the <code>errors</code> directory
          based on <code>errors/template.md</code>:
        </p>
        <pre
          class="shell"
        ><code>cp errors/template.md errors/&lt;error-file-name&gt;.md</code></pre>
      </li>
      <li>Add the newly added file to <code>errors/manifest.json</code></li>
      <li>
        <p>
          Add the following url to your warning/error:
          <code
            >https://nextjs.org/docs/messages/&lt;file-path-without-dotmd&gt;</code
          >.
        </p>
        <p>
          For example, to link to
          <code>errors/api-routes-static-export.md</code> you use the url:
          <code>https://nextjs.org/docs/messages/api-routes-static-export</code>
        </p>
      </li>
    </ol>
    <h2 id="adding-examples">Adding examples</h2>
    <p>
      When you add an example to the <a href="examples">examples</a> directory,
      don’t forget to add a <code>README.md</code> file with the following
      format:
    </p>
    <ul>
      <li>
        Replace <code>DIRECTORY_NAME</code> with the directory name you’re
        adding.
      </li>
      <li>Fill in <code>Example Name</code> and <code>Description</code>.</li>
      <li>
        To add additional installation instructions, please add it where
        appropriate.
      </li>
      <li>
        To add additional notes, add <code>## Notes</code> section at the end.
      </li>
      <li>
        Remove the <code>Deploy your own</code> section if your example can’t be
        immediately deployed to Vercel.
      </li>
      <li>
        Remove the <code>Preview</code> section if the example doesn’t work on
        <a href="http://stackblitz.com/">StackBlitz</a> and file an issue
        <a href="https://github.com/stackblitz/webcontainer-core">here</a>.
      </li>
    </ul>
    <div class="sourceCode" id="cb18">
      <pre
        class="sourceCode markdown"
      ><code class="sourceCode markdown"><a class="sourceLine" id="cb18-1" title="1"><span class="fu"># Example Name</span></a>
<a class="sourceLine" id="cb18-2" title="2"></a>
<a class="sourceLine" id="cb18-3" title="3">Description</a>
<a class="sourceLine" id="cb18-4" title="4"></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="fu">## Preview</span></a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7">Preview the example live on <span class="ot">[StackBlitz](http://stackblitz.com/)</span>:</a>
<a class="sourceLine" id="cb18-8" title="8"></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="ot">[![Open in StackBlitz](https://developer.stackblitz.com/img/open_in_stackblitz.svg)</span>](https://stackblitz.com/github/vercel/next.js/tree/canary/examples/DIRECTORY_NAME)</a>
<a class="sourceLine" id="cb18-10" title="10"></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="fu">## Deploy your own</span></a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13">Deploy the example using <span class="ot">[Vercel](https://vercel.com?utm_source=github&amp;utm_medium=readme&amp;utm_campaign=next-example)</span>:</a>
<a class="sourceLine" id="cb18-14" title="14"></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="ot">[![Deploy with Vercel](https://vercel.com/button)</span>](https://vercel.com/new/git/external?repository-url=https://github.com/vercel/next.js/tree/canary/examples/DIRECTORY_NAME&amp;project-name=DIRECTORY_NAME&amp;repository-name=DIRECTORY_NAME)</a>
<a class="sourceLine" id="cb18-16" title="16"></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="fu">## How to use</span></a>
<a class="sourceLine" id="cb18-18" title="18"></a>
<a class="sourceLine" id="cb18-19" title="19">Execute <span class="ot">[`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app)</span> with <span class="ot">[npm](https://docs.npmjs.com/cli/init)</span> or <span class="ot">[Yarn](https://yarnpkg.com/lang/en/docs/cli/create/)</span> to bootstrap the example:</a>
<a class="sourceLine" id="cb18-20" title="20"></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="bn">```bash</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="bn">npx create-next-app --example DIRECTORY_NAME DIRECTORY_NAME-app</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="bn"># or</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="bn">yarn create next-app --example DIRECTORY_NAME DIRECTORY_NAME-app</span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="bn">```</span></a>
<a class="sourceLine" id="cb18-26" title="26"></a>
<a class="sourceLine" id="cb18-27" title="27">Deploy it to the cloud with <span class="ot">[Vercel](https://vercel.com/new?utm_source=github&amp;utm_medium=readme&amp;utm_campaign=next-example)</span> (<span class="ot">[Documentation](https://nextjs.org/docs/deployment))</span>.</a></code></pre>
    </div>
    <h2 id="publishing">Publishing</h2>
    <p>
      Repository maintainers can use <code>yarn publish-canary</code> to publish
      a new version of all packages to npm.
    </p>
  </body>
</html>
