<!doctype html>
<html lang="en">
  
<!-- Mirrored from www.abeautifulsite.net/posts/using-an-orm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Oct 2021 09:00:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using an ORM</title>
    <meta name="description" content="Trying something new with databases.">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="alternate" href="../feed/feed.xml" type="application/atom+xml" title="A Beautiful Site">
    <link rel="alternate" href="../feed/feed.json" type="application/json" title="A Beautiful Site">
    <link rel="icon" href="../images/logos/leaf.svg" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.gstatic.com/">
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  </head>
  <body class="post-template">
    <header>
      <a href="../index.html" class="header-link">
        <img src="../images/logos/wordmark.svg" alt="A Beautiful Site" class="wordmark">
      </a>

      <nav class="nav">
          <a class="nav-item" href="../index.html">
            Home
          </a>
          <a class="nav-item" href="../tags/index.html">
            Tags
          </a>
          <a class="nav-item" href="index.html">
            Archive
          </a>
          <a class="nav-item" href="../about/index.html">
            About
          </a>
        <a class="nav-item" href="#search" arial-label="Search" title="Press / to search" data-site-search>
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16">
            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
          </svg>
        </a>
      </nav>
    </header>

    <main class="content">
      
<hr>

<article class="post">
  <h1>Using an ORM</h1>

  <div class="post-date">
    <time datetime="2017-02-06">
      February 06, 2017
    </time>
    &bull;
    2 min read
  </div>

  

  <p>I've never really bothered with <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORMs</a> before, as feelings for them tend to be mixed. I've heard that you can spend twice as long learning an ORM as you can coding raw SQL. ü§∑üèª‚Äç‚ôÇÔ∏è</p>
<p>I figured it was time to see for myself. For the Postleaf rebuild, I decided to try out <a href="http://docs.sequelizejs.com/en/v3/">Sequelize</a>. I discovered it some time ago and really liked what I saw, but never had a chance to use it. I'm glad I finally did.</p>
<p>The previous version of Postleaf required MySQL. All the models were written from scratch, including CRUD methods (create, read, update, delete) and validation. Believe me when I say that you can waste <em>a lot of time</em> writing your own CRUD methods.</p>
<p>To make matters worse, some of the queries were proprietary, meaning they'd only work with MySQL. I've wanted to remove that requirement for a long time.</p>
<p>An ORM can alleviate these pain points. Sequelize, for example, lets you define models and validation using a simple JSON object. It even creates the database schema and models for you, after which you can query the database without writing any SQL at all.</p>
<p>For example:</p>
<pre><code class="language-js">// Find the user named Joe
User.findOne({
  where: {
    name: 'Joe'
  }
}).then((user) =&gt; {
  console.log(user.name); // &quot;Joe&quot;
});
</code></pre>
<p>That's roughly the same as this:</p>
<pre><code class="language-sql">SELECT id, name, email FROM users WHERE name = 'Joe'
</code></pre>
<p>It may seem a bit more verbose for simple queries, but once you start associating models the benefits are more easily understood. With just one additional line of code, I can fetch the user along with all of his posts:</p>
<pre><code class="language-js">// Find Joe and fetch all of his posts
User.findOne({
  where: {
    name: 'Joe'
  },
  include: Post
}).then((user) =&gt; {
  console.log(user.name); // &quot;Joe&quot;
  console.log(user.posts); // Posts authored by Joe
});
</code></pre>
<p>It gets even more exciting when you realize that Sequelize doesn't just return the raw data, it returns the data as a series of model objects. That means you can do things like this:</p>
<pre><code class="language-js">// Find Joe and change his name to Bob
User.findOne({
  where: {
    name: 'Joe'
  }
}).then((user) =&gt; {
  user.name = 'Bob';
  user.save(); // commit to database
});
</code></pre>
<p>Since raw SQL queries are abstracted into code, I don't have to worry about database-specific quirks ‚Äî Sequelize does all that in the background. As long as I stick to their API (and avoid database-specific features), Postleaf will be able to run on top of any database that Sequelize supports. (Currently SQLite, MySQL, MariaDB, MSSQL, and PostgreSQL.)</p>
<p>For now, I've decided to develop with SQLite. It's fast, and I love having a single database file in a known location that you can quickly duplicate or replace. It's great for testing, but I'm definitely trying to support all five platforms for release!</p>


  <div class="tags">
    
  <a href="../tags/postleaf/index.html" class="post-tag">postleaf</a>
  <a href="../tags/databases/index.html" class="post-tag">databases</a>
  <a href="../tags/development/index.html" class="post-tag">development</a>

  </div>
</article>

<hr>

<footer class="post-footer">
  <img src="http://0.gravatar.com/avatar/bf1b3b95fd5b096a3592247c29667b33?s=512" alt="Photo of Cory" class="avatar avatar-small">

  <p>
    Written by <a href="../index-4.html">Cory LaViska</a>, a software engineer and UX architect responsible for
    <a href="https://shoelace.style/">Shoelace.style</a>, <a href="https://www.surrealcms.com/">Surreal&nbsp;CMS</a>, and
    other <a href="https://github.com/claviska">open source things</a>.
  </p>

  <p>
    You can follow Cory on <a href="https://twitter.com/claviska">Twitter</a> and <a href="https://github.com/claviska">GitHub</a>.
  </p>
</footer>

<hr>

<nav class="post-nav">
    <a href="solving-the-search-problem/index.html" class="post-nav-previous">
      <small>Previous post</small>
      Solving the search problem
    </a>
  
    <a href="hashing-passwords-with-nodejs-and-bcrypt/index.html" class="post-nav-next">
      <small>Up next</small>
      Hashing Passwords with Node.js and bcrypt
    </a>
  
</nav>

    </main>

    <div class="site-search" hidden>
      <div class="site-search-panel">
        <header class="site-search-header">
          <input type="text" placeholder="Search" class="site-search-input">
        </header>
        <div class="site-search-body">
          <ul class="site-search-results"></ul>
        </div>
      </div>
    </div>

    <script src="../../cdn.jsdelivr.net/npm/lunr%402.3.9/lunr.min.js"></script>
    <script src="../js/search.js"></script>

    <script defer src="../js/greeting.js"></script>
    <script defer src="../../cdn.jsdelivr.net/gh/PrismJS/prism%401.23.0/prism.js"></script>
    <script defer src="../../cdn.jsdelivr.net/npm/prismjs%401.23.0/components/prism-bash.js"></script>
    <script defer src="../../cdn.jsdelivr.net/npm/prismjs%401.23.0/components/prism-markup-templating.js"></script>
    <script defer src="../../cdn.jsdelivr.net/npm/prismjs%401.23.0/components/prism-php.js"></script>
    <script defer src="../../cdn.jsdelivr.net/npm/prismjs%401.23.0/components/prism-typescript.js"></script>

    <!-- Current page: /posts/using-an-orm/ -->
  </body>

<!-- Mirrored from www.abeautifulsite.net/posts/using-an-orm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Oct 2021 09:00:22 GMT -->
</html>
