<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>CodePen Embed - Excel To Markdown Table</title>
    <meta name="csrf-param" content="authenticity_token" />
    <meta
      name="csrf-token"
      content="xL0WWpd7pMF/Q1X5QR5qC73OXZlRB352vCX0P+FNmmmmw4nyEXiH79fc2LF9sJQZtRQX5YBPNol3GiKcXnECug=="
    />
    <link
      rel="stylesheet"
      media="all"
      href="https://cpwebassets.codepen.io/assets/embed/embed-42b7bfc03bd3f473aa580a69878917e48fc23057d459fb483559b44a952b356d.css"
    />
    <style>
      .hide {
        display: none !important;
      }

      #result-box {
        background: #fefefe;
        color: #333333;
      }
      .embed-footer,
      .embed-nav {
        background: #fefefe;
      }
      .embed-nav .code-types a,
      .embed-nav .result-button-list a,
      .action-button {
        color: #333333;
        background-color: #eeeeee;
      }
      .embed-nav .code-types a.active,
      .embed-nav .result-button-list a.active,
      .action-button.active {
        background: #cccccc;
        color: #333333;
        box-shadow: inset 0px 3px #333333;
      }
      .embed-nav .logo-wrap .edit-on-codepen {
        color: #333333;
      }

      .embed-nav svg {
        stroke: #333333 !important;
      }
    </style>
    <link
      rel="stylesheet"
      media="all"
      href="https://cpwebassets.codepen.io/assets/editor/themes/classic-e12de48c2932af7174b7bfaf66623a2c02fc2a149fa066224c890b703dcf432e.css"
    />
    <meta name="monetization" content="$ilp.uphold.com/biyqg2MkQKbe" />
  </head>
  <body
    id="the-body"
    style="border: 1px solid #eeeeee; --borderWidth: 1px"
    class="codepen-embed-body static"
  >
    <nav class="embed-nav group" id="embed-nav">
      <ul class="code-types">
        <li class="code-type">
          <a id="html-link" href="#html-box" role="button" aria-pressed="false">
            HTML
          </a>
        </li>
        <li class="code-type">
          <a id="css-link" href="#css-box" role="button" aria-pressed="false">
            CSS
          </a>
        </li>
        <li class="code-type">
          <a id="js-link" href="#js-box" role="button" aria-pressed="false">
            Babel
          </a>
        </li>
      </ul>
      <ul class="result-button-list">
        <li class="results results-type">
          <a
            id="result-link"
            href="#result-box"
            class="active"
            aria-pressed="true"
            role="button"
          >
            Result
          </a>
        </li>
        <li>
          <a href="#resources-link" id="skip-results-iframe-link"
            >Skip Results Iframe</a
          >
        </li>
      </ul>
      <div class="logo-wrap" id="edit-area">
        <a
          class="edit-on-codepen"
          target="_blank"
          rel="noopener"
          href="https://codepen.io/bgoonz/pen/JjNaPpL"
          title="Edit on CodePen"
        >
          <div class="large-logo">
            <span id="edit-on-text" class="open-on">EDIT ON</span>
            <svg
              id="embed-codepen-logo"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 138 26"
              fill="none"
              stroke="#000"
              stroke-width="2.3"
              stroke-linecap="round"
              stroke-linejoin="round"
              role="img"
              aria-label="CodePen"
            >
              <path
                d="M80 6h-9v14h9m34-14h-9v14h9m-3-7h-6m-28 0h-6m51 7V6l11 14V6M22 16.7L33 24l11-7.3V9.3L33 2 22 9.3v7.4zm22 0L33 9.3l-11 7.4m0-7.4l11 7.3 11-7.3M33 2v7.3m0 7.4V24m55-10h6c2.2 0 4-1.8 4-4s-1.8-4-4-4h-6v14M15 8c-1.3-1.3-3-2-5-2-4 0-7 3-7 7s3 7 7 7c2 0 3.7-.8 5-2m49-5c0 4-3 7-7 7h-5V6h5c4 0 7 3 7 7z"
              />
            </svg>
          </div>
          <div class="box-logo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="20 0 26 26"
              fill="none"
              stroke="#000"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2.3"
              role="img"
              aria-label="Edit on CodePen"
            >
              <path
                id="icon-codepen-box"
                d="M22 16.7L33 24l11-7.3V9.3L33 2 22 9.3v7.4zm22 0L33 9.3l-11 7.4m0-7.4l11 7.3 11-7.3M33 2v7.3m0 7.4V24"
              />
            </svg>
          </div>
        </a>
      </div>
    </nav>
    <div id="output" data-border-style="thin" data-header="true">
      <div
        id="html-box"
        class="code-wrap code-box box"
        role="region"
        aria-label="HTML"
      >
        <pre
          tabindex="0"
        ><code data-lang="htmlmixed" id="actual-html-code">&lt;body&gt;
    &lt;h1&gt;Copy Excel Paste Markdown&lt;/h1&gt;
    &lt;textarea id=&quot;editor&quot;&gt;&lt;/textarea&gt;
    &lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
      </div>
      <div
        id="css-box"
        class="code-wrap code-box box"
        role="region"
        aria-label="CSS"
      >
        <pre tabindex="0"><code data-lang="css" id="actual-css-code">textarea {
    width: 800px;
    height: 500px;
    font-family: &quot;Lucida Console&quot;;
}
</code></pre>
      </div>
      <div
        id="js-box"
        class="code-wrap code-box box"
        role="region"
        aria-label="JS"
      >
        <pre
          tabindex="0"
        ><code data-lang="jsx" id="actual-js-code">var editor = document.getElementById(&quot;editor&quot;);

function columnWidth(rows, columnIndex) {
    return Math.max.apply(
        null,
        rows.map(function (row) {
            return (&quot;&quot; + row[columnIndex]).length;
        })
    );
}

function looksLikeTable(data) {
    return true;
}

editor.addEventListener(&quot;paste&quot;, function (event) {
    var clipboard = event.clipboardData;
    var data = clipboard.getData(&quot;text/plain&quot;).trim();

    if (looksLikeTable(data)) {
        event.preventDefault();
    } else {
        return;
    }

    var rows = data.split(/[\u0085\u2028\u2029]|\r\n?/g).map(function (row) {
        row = row.replace(&quot;\n&quot;, &quot; &quot;);
        return row.split(&quot;\t&quot;);
    });

    var colAlignments = [];

    var columnWidths = rows[0].map(function (column, columnIndex) {
        var alignment = &quot;l&quot;;
        var re = /^(\^[lcr])/i;
        var m = column.match(re);
        if (m) {
            var align = m[1][1].toLowerCase();
            if (align === &quot;c&quot;) {
                alignment = &quot;c&quot;;
            } else if (align === &quot;r&quot;) {
                alignment = &quot;r&quot;;
            }
        }
        colAlignments.push(alignment);
        column = column.replace(re, &quot;&quot;);
        rows[0][columnIndex] = column;
        return columnWidth(rows, columnIndex);
    });
    var markdownRows = rows.map(function (row, rowIndex) {
        // | Name         | Title | Email Address  |
        // |--------------|-------|----------------|
        // | Jane Atler   | CEO   | jane@acme.com  |
        // | John Doherty | CTO   | john@acme.com  |
        // | Sally Smith  | CFO   | sally@acme.com |
        return (
            &quot;| &quot; +
            row
                .map(function (column, index) {
                    return (
                        column +
                        Array(columnWidths[index] - column.length + 1).join(&quot; &quot;)
                    );
                })
                .join(&quot; | &quot;) +
            &quot; |&quot;
        );
        row.map;
    });
    markdownRows.splice(
        1,
        0,
        &quot;|&quot; +
            columnWidths
                .map(function (width, index) {
                    var prefix = &quot;&quot;;
                    var postfix = &quot;&quot;;
                    var adjust = 0;
                    var alignment = colAlignments[index];
                    if (alignment === &quot;r&quot;) {
                        postfix = &quot;:&quot;;
                        adjust = 1;
                    } else if (alignment == &quot;c&quot;) {
                        prefix = &quot;:&quot;;
                        postfix = &quot;:&quot;;
                        adjust = 2;
                    }
                    return (
                        prefix +
                        Array(columnWidths[index] + 3 - adjust).join(&quot;-&quot;) +
                        postfix
                    );
                })
                .join(&quot;|&quot;) +
            &quot;|&quot;
    );

    // https://www.w3.org/TR/clipboard-apis/#the-paste-action
    // When pasting, the drag data store mode flag is read-only, hence calling
    // setData() from a paste event handler will not modify the data that is
    // inserted, and not modify the data on the clipboard.

    event.target.value = markdownRows.join(&quot;\n&quot;);
    return false;
});
</code></pre>
        <a
          href="#0"
          id="view-js-compiled-button"
          class="action-button bottom right view-compiled-button"
          data-type="js"
        >
          View Compiled
        </a>
      </div>
      <div
        id="result-box"
        class="code-box active zoom-1"
        role="region"
        aria-label="Result"
      >
        <iframe
          allow="accelerometer; camera; encrypted-media; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write"
          allowfullscreen="true"
          allowpaymentrequest="true"
          allowTransparency="true"
          class="result-iframe"
          frameborder="0"
          id="result-iframe"
          loading="lazy"
          name="CodePen Preview for Excel To Markdown Table"
          sandbox="allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
          scrolling="yes"
          title="CodePen Preview for Excel To Markdown Table"
          data-src="https://cdpn.io/bgoonz/fullembedgrid/JjNaPpL?animations=run&type=embed"
          src="https://cdpn.io/bgoonz/fullembedgrid/JjNaPpL?animations=run&type=embed"
        >
        </iframe>
      </div>
      <div id="about-box">
        <div class="about-container">
          <div class="about-user">
            <a href="https://codepen.io/bgoonz" target="_blank" rel="noopener"
              ><img
                src="https://assets.codepen.io/5160002/internal/avatars/users/default.png?fit=crop&amp;format=auto&amp;height=256&amp;version=1612640830&amp;width=256"
                loading="lazy"
                alt=""
                class="about-image"
            /></a>
            <div class="about-user-info">
              <p>
                This Pen is owned by
                <a
                  href="https://codepen.io/bgoonz"
                  target="_blank"
                  rel="noopener"
                  >Bryan C Guner</a
                >
                on
                <a href="https://codepen.io" target="_blank" rel="noopener"
                  >CodePen</a
                >.
              </p>
              <p>
                <a
                  href="/bgoonz"
                  target="_blank"
                  rel="noopener"
                  class="about-user-more"
                >
                  See more by @bgoonz on CodePen
                </a>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div id="resources-box" class="resources-box">
        <h3>External CSS</h3>
        <p>This Pen doesn't use any external CSS resources.</p>
        <h3>External JavaScript</h3>
        <p>This Pen doesn't use any external JavaScript resources.</p>
      </div>
    </div>
    <footer class="embed-footer" id="embed-footer">
      <button
        id="resources-link"
        class="resources-link action-button bottom left"
        href="#resources-box"
        aria-pressed="false"
        role="button"
      >
        Resources
      </button>
      <ul class="scaling-choices bottom right">
        <li><button class="action-button" id="zoom-button-1">1×</button></li>
        <li><button class="action-button" id="zoom-button-05">0.5×</button></li>
        <li>
          <button class="action-button" id="zoom-button-025">0.25×</button>
        </li>
      </ul>
      <button id="rerun-button" class="action-button rerun-button bottom right">
        Rerun
      </button>
    </footer>
    <script nonce="PEZk/ac+fN4=">
      __processedPen = {
        html: "&lt;body&gt;\n    &lt;h1&gt;Copy Excel Paste Markdown&lt;/h1&gt;\n    &lt;textarea id=&quot;editor&quot;&gt;&lt;/textarea&gt;\n    &lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;",
        css: "textarea {\n    width: 800px;\n    height: 500px;\n    font-family: &quot;Lucida Console&quot;;\n}",
        js: "var editor = document.getElementById(&quot;editor&quot;);\n\nfunction columnWidth(rows, columnIndex) {\n  return Math.max.apply(\n  null,\n  rows.map(function (row) {\n    return (&quot;&quot; + row[columnIndex]).length;\n  }));\n\n}\n\nfunction looksLikeTable(data) {\n  return true;\n}\n\neditor.addEventListener(&quot;paste&quot;, function (event) {\n  var clipboard = event.clipboardData;\n  var data = clipboard.getData(&quot;text/plain&quot;).trim();\n\n  if (looksLikeTable(data)) {\n    event.preventDefault();\n  } else {\n    return;\n  }\n\n  var rows = data.split(/[\\u0085\\u2028\\u2029]|\\r\\n?/g).map(function (row) {\n    row = row.replace(&quot;\\n&quot;, &quot; &quot;);\n    return row.split(&quot;\\t&quot;);\n  });\n\n  var colAlignments = [];\n\n  var columnWidths = rows[0].map(function (column, columnIndex) {\n    var alignment = &quot;l&quot;;\n    var re = /^(\\^[lcr])/i;\n    var m = column.match(re);\n    if (m) {\n      var align = m[1][1].toLowerCase();\n      if (align === &quot;c&quot;) {\n        alignment = &quot;c&quot;;\n      } else if (align === &quot;r&quot;) {\n        alignment = &quot;r&quot;;\n      }\n    }\n    colAlignments.push(alignment);\n    column = column.replace(re, &quot;&quot;);\n    rows[0][columnIndex] = column;\n    return columnWidth(rows, columnIndex);\n  });\n  var markdownRows = rows.map(function (row, rowIndex) {\n    // | Name         | Title | Email Address  |\n    // |--------------|-------|----------------|\n    // | Jane Atler   | CEO   | jane@acme.com  |\n    // | John Doherty | CTO   | john@acme.com  |\n    // | Sally Smith  | CFO   | sally@acme.com |\n    return (\n      &quot;| &quot; +\n      row.\n      map(function (column, index) {\n        return (\n          column +\n          Array(columnWidths[index] - column.length + 1).join(&quot; &quot;));\n\n      }).\n      join(&quot; | &quot;) +\n      &quot; |&quot;);\n\n    row.map;\n  });\n  markdownRows.splice(\n  1,\n  0,\n  &quot;|&quot; +\n  columnWidths.\n  map(function (width, index) {\n    var prefix = &quot;&quot;;\n    var postfix = &quot;&quot;;\n    var adjust = 0;\n    var alignment = colAlignments[index];\n    if (alignment === &quot;r&quot;) {\n      postfix = &quot;:&quot;;\n      adjust = 1;\n    } else if (alignment == &quot;c&quot;) {\n      prefix = &quot;:&quot;;\n      postfix = &quot;:&quot;;\n      adjust = 2;\n    }\n    return (\n      prefix +\n      Array(columnWidths[index] + 3 - adjust).join(&quot;-&quot;) +\n      postfix);\n\n  }).\n  join(&quot;|&quot;) +\n  &quot;|&quot;);\n\n\n  // https://www.w3.org/TR/clipboard-apis/#the-paste-action\n  // When pasting, the drag data store mode flag is read-only, hence calling\n  // setData() from a paste event handler will not modify the data that is\n  // inserted, and not modify the data on the clipboard.\n\n  event.target.value = markdownRows.join(&quot;\\n&quot;);\n  return false;\n});",
      };
      __preprocessors = {
        html: "none",
        css: "none",
        js: "babel",
      };
      __preprocessorNames = {
        html: "HTML",
        css: "CSS",
        js: "Babel",
      };
      __editable = false;
      __embed_prefill = false;
    </script>
    <script src="https://cpwebassets.codepen.io/assets/embed/embed-e369dee9e85a1a53638c341339102b70938d2f103a2252bc1bf4c7ec1dc26212.js"></script>
  </body>
</html>
